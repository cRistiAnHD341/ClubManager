<Window x:Class="ClubManager.Views.ExportWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Exportar Datos" Height="650" Width="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="#FF2D2D30">

    <Window.Resources>
        <!-- Estilos modernos -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="#FF007ACC"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="15,10"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="5"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FF005A9E"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#FF004578"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CancelButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="#FF6C757D"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FF5A6268"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#FF495057"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SuccessButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="#FF28A745"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FF218838"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#FF1E7E34"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderBrush" Value="#FF007ACC"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5">
                            <ScrollViewer x:Name="PART_ContentHost" 
                                        Margin="{TemplateBinding Padding}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ModernComboBox" TargetType="ComboBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderBrush" Value="#FF007ACC"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style x:Key="ModernCheckBox" TargetType="CheckBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="0,5"/>
        </Style>

        <Style x:Key="ModernRadioButton" TargetType="RadioButton">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="0,5"/>
        </Style>

        <Style x:Key="ModernLabel" TargetType="Label">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <Style x:Key="TitleLabel" TargetType="Label">
            <Setter Property="Foreground" Value="#FF007ACC"/>
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
        </Style>

        <Style x:Key="SectionTitle" TargetType="Label">
            <Setter Property="Foreground" Value="#FF007ACC"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="0,15,0,10"/>
        </Style>

        <Style x:Key="ProgressBarStyle" TargetType="ProgressBar">
            <Setter Property="Height" Value="20"/>
            <Setter Property="Background" Value="#FF3F3F46"/>
            <Setter Property="Foreground" Value="#FF007ACC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#FF007ACC"/>
        </Style>
    </Window.Resources>

    <Grid Margin="30">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Título -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <Label Content="📤 Exportar Datos" Style="{StaticResource TitleLabel}"/>
            <TextBlock Text="Exporta los datos de abonados en diferentes formatos" 
                       HorizontalAlignment="Center" 
                       Foreground="#FFCCCCCC" 
                       FontSize="14" 
                       Margin="0,10,0,0"/>
        </StackPanel>

        <!-- Contenido Principal -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Columna Izquierda - Configuración -->
                <Border Grid.Column="0" Background="#FF1E1E1E" CornerRadius="10" Padding="20">
                    <StackPanel>
                        <Label Content="⚙️ Configuración de Exportación" Style="{StaticResource SectionTitle}"/>

                        <!-- Formato de exportación -->
                        <Label Content="Formato de archivo:" Style="{StaticResource ModernLabel}"/>
                        <ComboBox Style="{StaticResource ModernComboBox}"
                                  ItemsSource="{Binding FormatosExportacion}"
                                  SelectedValue="{Binding FormatoSeleccionado}"
                                  DisplayMemberPath="Display"
                                  SelectedValuePath="Value"
                                  Margin="0,5,0,15"/>

                        <!-- Datos a exportar -->
                        <Label Content="Datos a incluir:" Style="{StaticResource SectionTitle}"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding IncluirNumeroSocio}"
                                  Content="🔢 Número de socio"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding IncluirNombreCompleto}"
                                  Content="👤 Nombre completo"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding IncluirDNI}"
                                  Content="🆔 DNI"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding IncluirEstado}"
                                  Content="✅ Estado (Activo/Inactivo)"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding IncluirPeña}"
                                  Content="🎪 Peña"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding IncluirTipoAbono}"
                                  Content="🎫 Tipo de abono"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding IncluirPrecio}"
                                  Content="💰 Precio"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding IncluirGestor}"
                                  Content="🏢 Gestor"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding IncluirCodigoBarras}"
                                  Content="🔗 Código de barras"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding IncluirFechaCreacion}"
                                  Content="📅 Fecha de alta"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding IncluirEstadoImpresion}"
                                  Content="🖨️ Estado de impresión"/>

                        <!-- Filtros -->
                        <Label Content="🔍 Filtros:" Style="{StaticResource SectionTitle}"/>

                        <Label Content="Estado:" Style="{StaticResource ModernLabel}"/>
                        <ComboBox Style="{StaticResource ModernComboBox}"
                                  ItemsSource="{Binding FiltrosEstado}"
                                  SelectedValue="{Binding FiltroEstadoSeleccionado}"
                                  DisplayMemberPath="Display"
                                  SelectedValuePath="Value"
                                  Margin="0,5,0,10"/>

                        <Label Content="Peña:" Style="{StaticResource ModernLabel}"/>
                        <ComboBox Style="{StaticResource ModernComboBox}"
                                  ItemsSource="{Binding FiltrosPeña}"
                                  SelectedValue="{Binding FiltroPeñaSeleccionado}"
                                  DisplayMemberPath="Nombre"
                                  SelectedValuePath="Id"
                                  Margin="0,5,0,10"/>

                        <Label Content="Tipo de abono:" Style="{StaticResource ModernLabel}"/>
                        <ComboBox Style="{StaticResource ModernComboBox}"
                                  ItemsSource="{Binding FiltrosTipoAbono}"
                                  SelectedValue="{Binding FiltroTipoAbonoSeleccionado}"
                                  DisplayMemberPath="Nombre"
                                  SelectedValuePath="Id"
                                  Margin="0,5,0,15"/>
                    </StackPanel>
                </Border>

                <!-- Columna Derecha - Vista Previa y Opciones -->
                <Border Grid.Column="2" Background="#FF1E1E1E" CornerRadius="10" Padding="20">
                    <StackPanel>
                        <Label Content="👀 Vista Previa" Style="{StaticResource SectionTitle}"/>

                        <!-- Resumen -->
                        <Border Background="#FF3F3F46" CornerRadius="5" Padding="15" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="{Binding ResumenExportacion}" 
                                           Foreground="White" FontWeight="SemiBold" 
                                           TextWrapping="Wrap" LineHeight="20"/>
                            </StackPanel>
                        </Border>

                        <!-- Opciones adicionales -->
                        <Label Content="📝 Opciones Adicionales:" Style="{StaticResource SectionTitle}"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding IncluirEncabezados}"
                                  Content="📋 Incluir encabezados de columna"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding AbrirDespuesExportar}"
                                  Content="📂 Abrir archivo después de exportar"/>

                        <CheckBox Style="{StaticResource ModernCheckBox}"
                                  IsChecked="{Binding IncluirFechaEnNombre}"
                                  Content="📅 Incluir fecha en nombre del archivo"/>

                        <!-- Configuración de archivo -->
                        <Label Content="💾 Configuración del Archivo:" Style="{StaticResource SectionTitle}"/>

                        <Label Content="Nombre del archivo:" Style="{StaticResource ModernLabel}"/>
                        <TextBox Style="{StaticResource ModernTextBox}"
                                 Text="{Binding NombreArchivo, UpdateSourceTrigger=PropertyChanged}"
                                 Margin="0,5,0,10"/>

                        <Label Content="Carpeta de destino:" Style="{StaticResource ModernLabel}"/>
                        <Grid Margin="0,5,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Column="0" Style="{StaticResource ModernTextBox}"
                                     Text="{Binding CarpetaDestino, UpdateSourceTrigger=PropertyChanged}"
                                     IsReadOnly="True"/>
                            <Button Grid.Column="1" Content="📂" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding SelectFolderCommand}"
                                    Margin="10,0,0,0" Padding="10"/>
                        </Grid>

                        <!-- Vista previa de columnas -->
                        <Label Content="📊 Columnas a exportar:" Style="{StaticResource SectionTitle}"/>

                        <Border Background="#FF3F3F46" CornerRadius="5" Padding="10" Height="150">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <ItemsControl ItemsSource="{Binding ColumnasSeleccionadas}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding}" 
                                                       Foreground="White" 
                                                       FontSize="12" 
                                                       Margin="0,2"/>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Border>

                        <!-- Progreso de exportación -->
                        <Label Content="📈 Progreso:" Style="{StaticResource SectionTitle}" 
                               Visibility="{Binding ShowProgress}"/>

                        <ProgressBar Style="{StaticResource ProgressBarStyle}"
                                     Value="{Binding ProgressValue}"
                                     Visibility="{Binding ShowProgress}"
                                     Margin="0,5,0,10"/>

                        <TextBlock Text="{Binding ProgressText}"
                                   Foreground="#FFCCCCCC"
                                   HorizontalAlignment="Center"
                                   Visibility="{Binding ShowProgress}"/>
                    </StackPanel>
                </Border>
            </Grid>
        </ScrollViewer>

        <!-- Botones -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button Content="🔄 Vista Previa" 
                    Style="{StaticResource ModernButton}"
                    Command="{Binding PreviewCommand}"
                    Margin="0,0,15,0"/>
            <Button Content="❌ Cancelar" 
                    Style="{StaticResource CancelButton}"
                    IsCancel="True"
                    Click="CancelButton_Click" 
                    Margin="0,0,15,0"/>
            <Button Content="📤 Exportar" 
                    Style="{StaticResource SuccessButton}"
                    IsDefault="True"
                    Command="{Binding ExportCommand}"/>
        </StackPanel>
    </Grid>
</Window>